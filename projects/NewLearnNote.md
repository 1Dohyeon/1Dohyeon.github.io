# NewLearnNote: AI와 집단지성 기반 지식 관리 및 노트 앱

## 프로젝트 개요

![nln-main-img](https://github.com/1Dohyeon/1Dohyeon.github.io/blob/main/public/nln-main-img.png?raw=true)

> 서비스 정보
>
> - 서비스명: NewLearn Note
> - 비전: AI와 집단지성을 활용한 차세대 지식 관리 및 학습 플랫폼
> - 배포 상태: 테스트 서버 배포

### 왜 이 프로젝트를 시작했는가?

**옵시디언에서 공부하고, 블로그에 공유하고, 구글링으로 자료 찾으면서 공부할 때마다 여러 페이지를 왔다갔다하는 게 너무 귀찮았습니다.**

이 불편함을 해결하기 위해 NewLearn Note를 기획했습니다. 노트 작성, 공유, 다른 사용자의 학습 자료 참고를 하나의 앱에서 해결하는 것이 목표입니다. 향후 "이 파일 참고해서 필기해줘"와 같은 AI 어시스턴트 기능도 계획 중이며, 해당 프로토타입은 [Nura](https://1dohyeon.github.io/#/projects/nura)에서 개발했습니다.

### 핵심 기능: Library와 노트 네트워크

GitHub에서 Repository에 코드를 push/pull하듯, NewLearn Note에서는 **Library**에 노트를 동기화합니다.

- **Library 구조**: 각 Library는 `private`과 `public` 브랜치로 구성
- **동기화**: 로컬 폴더와 Library 간 push/pull로 노트 동기화 (private 브랜치에 저장)
- **Publish**: 로컬에서 Publish 버튼 클릭 시, 해당 노트와 백링크(`[[ ]]` 문법)로 연결된 노트들이 public 브랜치에 복제
- **노트 네트워크**: 다른 사용자가 공개된 노트를 자신의 노트에서 link로 참조하면, DB의 `note-network` 테이블에 관계가 저장되어 집단지성 네트워크 형성

## 개발 내용

### 1. RESTful API 서버 아키텍처 설계 및 PostgreSQL DB 모델링

**아키텍처 설계:**
- NestJS 기반 모듈형 아키텍처 구성으로 도메인별 관심사 분리
- Repository 패턴을 통한 데이터 접근 계층 추상화
- 도메인 이벤트 패턴 적용으로 모듈 간 느슨한 결합 구현

**데이터베이스 설계:**
- Library, Note, User 등 핵심 엔티티 간 관계 모델링
- `note-network` 테이블 설계로 노트 간 참조 관계를 그래프 구조로 저장
- 인덱스 최적화를 통한 쿼리 성능 향상

### 2. Google OAuth 2.0 소셜 로그인 연동

**OAuth 플로우 구현:**
- Passport.js를 활용한 Google OAuth 2.0 인증 파이프라인 구축
- 사용자 정보 자동 동기화 및 신규 사용자 자동 생성 로직 구현

### 3. JWT 인증/인가 시스템 및 도메인 이벤트 패턴 구현

**플랫폼별 인증 전략:**
- **웹/데스크톱 공통**: JWT 기반 stateless 인증으로 서버 확장성 확보
- **데스크톱 특화**: 안전한 로컬 스토리지에 토큰 저장하여 자동 로그인 구현

**토큰 관리:**
- Access Token 자동 갱신 로직으로 사용자 경험 개선
- Refresh Token 기반 장기 인증 유지

**도메인 이벤트 패턴:**
- 이벤트 기반 아키텍처로 모듈 간 의존성 최소화
- 노트 생성/수정/삭제 시 관련 서비스에 이벤트 전파

### 4. 노트 CRUD 및 버전 관리 시스템 구현

**노트 동기화 시스템:**
- GitHub처럼 Library에 노트를 push/pull하는 동기화 메커니즘 구현
- private/public 브랜치 개념으로 공개 범위 제어

**버전 관리:**
- 노트 변경 이력 추적 및 버전별 복원 기능
- 백링크(`[[ ]]` 문법) 자동 감지 및 관계 저장

### 5. Signed URL을 통한 안전한 GCS 파일 접근 권한 관리 및 노트 퍼블리싱 파이프라인 구축

**Signed URL 전략:**
- GCS에 저장된 파일에 대한 임시 접근 권한 부여
- 만료 시간 기반 보안으로 무단 접근 방지
- 서버 부하 없이 클라이언트가 직접 GCS와 통신

**노트 퍼블리싱 파이프라인:**
- 마크다운 노트를 정적 HTML로 변환
- 백링크로 연결된 관련 노트들을 자동으로 public 브랜치에 복제
- SEO 최적화를 위한 메타 태그 및 사이트맵 자동 생성
- GCS에 배포하여 별도의 웹 서버 없이 공개 노트 제공

### 6. GCP 기반 클라우드 인프라 구축 및 배포

**직접 관리 vs 관리형 서비스:**
초기 배포 시 Cloud SQL 대신 비용을 아끼고자 VM에 PostgreSQL을 직접 구축하는 방식을 선택했습니다. 

**구현 내용:**
- **컨테이너 기반 배포**: Docker를 활용한 NestJS 백엔드 컨테이너화로 개발/운영 환경 일관성 확보
- **데이터베이스 직접 관리**: GCP Compute Engine VM 내 PostgreSQL 직접 설치 및 설정, 스키마 모델링부터 쿼리 최적화까지 제어권 확보
- **정적 리소스 분리**: GCS를 활용한 이미지, 영상 등 정적 파일 저장으로 서버 스토리지 부하 감소

### 7. Next.js 기반, Electron.js 기반 데스크톱 앱 개발

**웹 애플리케이션 (Next.js):**
- SSR과 CSR을 혼합한 최적의 렌더링 전략
- 반응형 UI로 다양한 화면 크기 지원

**데스크톱 앱 (Electron.js):**
- **프로세스 분리**: `main` 프로세스에서 파일 시스템 접근, `renderer` 프로세스에서 Next.js 기반 UI 제공
- **IPC 통신**: `ipcHandlers.ts`를 통해 파일 CRUD, 프로젝트 관리 등 핵심 로직을 안전하게 처리
- **복잡한 상태 관리**: 멀티 탭/에디터 기능 구현, 파일 트리와 탭 상태 동기화

## 프로젝트를 통해 배운 점

이 프로젝트를 통해 기획부터 개발, 배포, 운영까지 서비스의 전반적인 라이프사이클을 경험했습니다. 특히 크로스 플랫폼 환경에서 사용자 로그인 상태를 어떻게 관리할지 깊게 고민하는 계기가 되었습니다. JWT 기반 인증을 웹과 데스크톱 모두에 적용하되, 데스크톱에서는 안전한 로컬 스토리지를 활용한 자동 로그인으로 각 플랫폼의 특성에 맞는 사용자 경험을 제공하면서, 보안성과 편의성을 모두 고려한 시스템 설계의 중요성을 깨달았습니다.
